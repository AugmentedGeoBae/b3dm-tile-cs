using Gltf.Core;
using NUnit.Framework;

namespace B3dm.Tile.Tests
{
    public class Texel77Tests
    {
        [Test]
        public void ReadTexel77Wkt()
        {
            // arrange
            var wkt = "POLYHEDRALSURFACE Z (((539331.14337996 6989327.32288392 47.0599333681166,539329.150111645 6989325.94557575 45.6469770846888,539328.560384186 6989325.53808584 45.2289403891191,539328.419989477 6989325.74310466 45.231703074649,539325.487441355 6989330.02551194 45.2894096663222,539325.078825643 6989330.62221421 45.2974503869191,539325.504958769 6989330.92722022 45.6030957372859,539325.56741077 6989330.97192041 45.647889633663,539324.161079419 6989332.93288791 45.6441698949784,539323.952437811 6989333.2238146 45.6436180388555,539325.879304239 6989334.66304361 47.0460112039,539328.08963181 6989331.58099243 47.0518569648266,539329.221181166 6989330.00317446 47.0548496292904,539329.877415806 6989329.08812903 47.0565852057189,539330.207801242 6989328.62744363 47.0574589921162,539330.832741855 6989327.75603399 47.0591118037701,539331.14337996 6989327.32288392 47.0599333681166)),((539331.143374691 6989327.32316954 57.0599741777405,539330.832736587 6989327.75631961 57.0591526152566,539330.207795976 6989328.62772925 57.0574998036027,539329.877410537 6989329.08841466 57.0566260172054,539329.2211759 6989330.00346008 57.0548904389143,539328.089626542 6989331.58127806 57.0518977753818,539325.879298971 6989334.66332924 57.0460520144552,539323.952432543 6989333.22410022 55.643658850342,539324.161074148 6989332.93317354 55.6442107064649,539325.567405502 6989330.97220603 55.6479304442182,539325.504953497 6989330.92750584 55.6031365487725,539325.078820374 6989330.62249983 55.2974911993369,539325.487436086 6989330.02579756 55.2894504768774,539328.419984209 6989325.74339028 55.2317438833416,539328.560378918 6989325.53837146 55.2289811996743,539329.150106377 6989325.94586137 55.647017898038,539331.143374691 6989327.32316954 57.0599741777405)),((539331.14337996 6989327.32288392 47.0599333681166,539331.143374691 6989327.32316954 57.0599741777405,539329.150106377 6989325.94586137 55.647017898038,539329.150111645 6989325.94557575 45.6469770846888,539331.14337996 6989327.32288392 47.0599333681166)),((539329.150111645 6989325.94557575 45.6469770846888,539329.150106377 6989325.94586137 55.647017898038,539328.560378918 6989325.53837146 55.2289811996743,539328.560384186 6989325.53808584 45.2289403891191,539329.150111645 6989325.94557575 45.6469770846888)),((539328.560384186 6989325.53808584 45.2289403891191,539328.560378918 6989325.53837146 55.2289811996743,539328.419984209 6989325.74339028 55.2317438833416,539328.419989477 6989325.74310466 45.231703074649,539328.560384186 6989325.53808584 45.2289403891191)),((539328.419989477 6989325.74310466 45.231703074649,539328.419984209 6989325.74339028 55.2317438833416,539325.487436086 6989330.02579756 55.2894504768774,539325.487441355 6989330.02551194 45.2894096663222,539328.419989477 6989325.74310466 45.231703074649)),((539325.487441355 6989330.02551194 45.2894096663222,539325.487436086 6989330.02579756 55.2894504768774,539325.078820374 6989330.62249983 55.2974911993369,539325.078825643 6989330.62221421 45.2974503869191,539325.487441355 6989330.02551194 45.2894096663222)),((539325.078825643 6989330.62221421 45.2974503869191,539325.078820374 6989330.62249983 55.2974911993369,539325.504953497 6989330.92750584 55.6031365487725,539325.504958769 6989330.92722022 45.6030957372859,539325.078825643 6989330.62221421 45.2974503869191)),((539325.504958769 6989330.92722022 45.6030957372859,539325.504953497 6989330.92750584 55.6031365487725,539325.567405502 6989330.97220603 55.6479304442182,539325.56741077 6989330.97192041 45.647889633663,539325.504958769 6989330.92722022 45.6030957372859)),((539325.56741077 6989330.97192041 45.647889633663,539325.567405502 6989330.97220603 55.6479304442182,539324.161074148 6989332.93317354 55.6442107064649,539324.161079419 6989332.93288791 45.6441698949784,539325.56741077 6989330.97192041 45.647889633663)),((539324.161079419 6989332.93288791 45.6441698949784,539324.161074148 6989332.93317354 55.6442107064649,539323.952432543 6989333.22410022 55.643658850342,539323.952437811 6989333.2238146 45.6436180388555,539324.161079419 6989332.93288791 45.6441698949784)),((539323.952437811 6989333.2238146 45.6436180388555,539323.952432543 6989333.22410022 55.643658850342,539325.879298971 6989334.66332924 57.0460520144552,539325.879304239 6989334.66304361 47.0460112039,539323.952437811 6989333.2238146 45.6436180388555)),((539325.879304239 6989334.66304361 47.0460112039,539325.879298971 6989334.66332924 57.0460520144552,539328.089626542 6989331.58127806 57.0518977753818,539328.08963181 6989331.58099243 47.0518569648266,539325.879304239 6989334.66304361 47.0460112039)),((539328.08963181 6989331.58099243 47.0518569648266,539328.089626542 6989331.58127806 57.0518977753818,539329.2211759 6989330.00346008 57.0548904389143,539329.221181166 6989330.00317446 47.0548496292904,539328.08963181 6989331.58099243 47.0518569648266)),((539329.221181166 6989330.00317446 47.0548496292904,539329.2211759 6989330.00346008 57.0548904389143,539329.877410537 6989329.08841466 57.0566260172054,539329.877415806 6989329.08812903 47.0565852057189,539329.221181166 6989330.00317446 47.0548496292904)),((539329.877415806 6989329.08812903 47.0565852057189,539329.877410537 6989329.08841466 57.0566260172054,539330.207795976 6989328.62772925 57.0574998036027,539330.207801242 6989328.62744363 47.0574589921162,539329.877415806 6989329.08812903 47.0565852057189)),((539330.207801242 6989328.62744363 47.0574589921162,539330.207795976 6989328.62772925 57.0574998036027,539330.832736587 6989327.75631961 57.0591526152566,539330.832741855 6989327.75603399 47.0591118037701,539330.207801242 6989328.62744363 47.0574589921162)),((539330.832741855 6989327.75603399 47.0591118037701,539330.832736587 6989327.75631961 57.0591526152566,539331.143374691 6989327.32316954 57.0599741777405,539331.14337996 6989327.32288392 47.0599333681166,539330.832741855 6989327.75603399 47.0591118037701)))";

            // transform matrix according to py3dtiles tool for 388 records tmp.tmp
            var transform = Transformer.GetTransform(539085.1221813804f, 6989220.68008033f, 52.98474913463f);
            var gltf = GltfReader.ReadFromWkt(wkt, transform);
            var glb = Packer.Pack(gltf);
            var b3dm = new B3dm {
                GlbData = glb
            };
            B3dmWriter.WriteB3dm(@"d:\aaa\b3dm\texel77.b3dm", b3dm);
            B3dmWriter.WriteGlb(@"d:\aaa\b3dm\texel77__.glb", b3dm);
            Assert.IsTrue(true);
        }
    }
}
